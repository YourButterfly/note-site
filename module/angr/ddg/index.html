



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://yourbutterfly.github.io/note-site/module/angr/ddg/">
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>DDG - butter-fly</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/custom.css">
    
      <link rel="stylesheet" href="../../../stylesheets/simpleLightbox.min.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#ddg" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://yourbutterfly.github.io/note-site/" title="butter-fly" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              butter-fly
            </span>
            <span class="md-header-nav__topic">
              
                DDG
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/YourButterfly/note-site.git/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    YourButterfly/note-site
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://yourbutterfly.github.io/note-site/" title="butter-fly" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    butter-fly
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/YourButterfly/note-site.git/" title="前往 Github 仓库" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    YourButterfly/note-site
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="首页" class="md-nav__link">
      首页
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      assembly
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        assembly
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../assembly/assembly/" title="assembly" class="md-nav__link">
      assembly
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      concolic
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        concolic
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1" checked>
    
    <label class="md-nav__link" for="nav-3-1">
      angr
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        angr
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../introduce/" title="angr-introduce" class="md-nav__link">
      angr-introduce
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cfg/" title="CFG" class="md-nav__link">
      CFG
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        DDG
      </label>
    
    <a href="./" title="DDG" class="md-nav__link md-nav__link--active">
      DDG
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    标题没想好
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class-ddganalysis" class="md-nav__link">
    class DDG(Analysis)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ddg9595init9595" class="md-nav__link">
    类DDG__init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95constructself" class="md-nav__link">
    构造_construct(self)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fast-question/" title="fast-questions" class="md-nav__link">
      fast-questions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../program-state/" title="program-state" class="md-nav__link">
      program-state
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sim_action/" title="sim_action" class="md-nav__link">
      sim_action
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      file format
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        file format
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../fileformat/dot/" title="DOT" class="md-nav__link">
      DOT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fileformat/pdf/" title="PDF" class="md-nav__link">
      PDF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      fuzzing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        fuzzing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../fuzzing/gui/" title="GUI" class="md-nav__link">
      GUI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fuzzing/honggfuzz/" title="honggfuzz" class="md-nav__link">
      honggfuzz
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      IOT
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        IOT
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../iot/binwalk/" title="binwalk" class="md-nav__link">
      binwalk
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      kernel
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        kernel
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel-debug/" title="kernel-debug" class="md-nav__link">
      kernel-debug
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel-kvm/" title="kernel-kvm" class="md-nav__link">
      kernel-kvm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel-header/" title="kernel-header" class="md-nav__link">
      kernel-header
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel-hook/" title="kernel-hook" class="md-nav__link">
      kernel-hook
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      llvm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        llvm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../llvm/pass/" title="pass" class="md-nav__link">
      pass
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      lua
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        lua
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../lua/lua/" title="lua" class="md-nav__link">
      lua
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      makefile
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        makefile
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../makefile/cmake/" title="cmake" class="md-nav__link">
      cmake
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/easyfunction/" title="easyfunction" class="md-nav__link">
      easyfunction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/python-flask/" title="flask" class="md-nav__link">
      flask
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/GooglePythonStyleGuide/" title="GooglePythonStyleGuide" class="md-nav__link">
      GooglePythonStyleGuide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/python-prompt-toolkit/" title="python-prompt-toolkit" class="md-nav__link">
      python-prompt-toolkit
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      semmel-ql
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        semmel-ql
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../semmle-ql/codeql/" title="CodeQL" class="md-nav__link">
      CodeQL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      webs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        webs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../webs/webs/" title="webs" class="md-nav__link">
      webs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      wireshark
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        wireshark
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../wireshark/tshark/" title="wireshark" class="md-nav__link">
      wireshark
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      others
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        others
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../others/others/" title="others" class="md-nav__link">
      others
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    标题没想好
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class-ddganalysis" class="md-nav__link">
    class DDG(Analysis)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ddg9595init9595" class="md-nav__link">
    类DDG__init__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95constructself" class="md-nav__link">
    构造_construct(self)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/YourButterfly/note-site.git/edit/master/docs/module/angr/ddg.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="ddg">DDG<a class="headerlink" href="#ddg" title="Permanent link">&para;</a></h1>
<p>数据依赖图分析</p>
<h2 id="_1">标题没想好<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>ddg.graph 的节点是CodeLocation object</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #e6db74">&quot;&quot;&quot;</span>
<span style="color: #e6db74">Constructor.</span>

<span style="color: #e6db74">:param int block_addr:      块地址</span>
<span style="color: #e6db74">:param int stmt_idx:        Statement ID. None for SimProcedures</span>
<span style="color: #e6db74">:param class sim_procedure: 对应的 SimProcedure class.</span>
<span style="color: #e6db74">:param int ins_addr:        指令地址. Optional.</span>
<span style="color: #e6db74">:param kwargs:              其他参数, will be stored, but not used in __eq__ or __hash__.</span>
<span style="color: #e6db74">&quot;&quot;&quot;</span>

<span style="color: #f92672">&lt;</span><span style="color: #ae81ff">0x40137b</span> <span style="color: #f8f8f2">id</span><span style="color: #f92672">=</span><span style="color: #ae81ff">0x40137b</span><span style="color: #f8f8f2">[</span><span style="color: #ae81ff">3</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">&gt;</span>
<span style="color: #f92672">&lt;</span><span style="color: #960050; background-color: #1e0010">$</span><span style="color: #f8f8f2">ins_addr</span> <span style="color: #f8f8f2">id</span><span style="color: #f92672">=</span><span style="color: #960050; background-color: #1e0010">$</span><span style="color: #f8f8f2">block_addr[</span><span style="color: #960050; background-color: #1e0010">$</span><span style="color: #f8f8f2">stmt_idx]</span><span style="color: #f92672">&gt;</span>
</pre></div>

<h2 id="class-ddganalysis">class DDG(Analysis)<a class="headerlink" href="#class-ddganalysis" title="Permanent link">&para;</a></h2>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span>    This is a fast data dependence graph directly generated from our CFG analysis result. The only reason for its
    existence is the speed. There is zero guarantee for being sound or accurate. You are supposed to use it only when
    you want to track the simplest data dependence, and you do not care about soundness or accuracy.

    For a better data dependence graph, please consider performing a better static analysis first (like Value-set
    Analysis), and then construct a dependence graph on top of the analysis result (for example, the VFG in angr).

    Also note that since we are using states from CFG, any improvement in analysis performed on CFG (like a points-to
    analysis) will directly benefit the DDG.
</pre></div>

<h3 id="ddg9595init9595">类DDG__init__<a class="headerlink" href="#ddg9595init9595" title="Permanent link">&para;</a></h3>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span>    <span style="color: #a6e22e">__init__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">cfg,</span> <span style="color: #f8f8f2">start</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None,</span> <span style="color: #f8f8f2">call_depth</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None,</span> <span style="color: #f8f8f2">block_addrs</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None)</span>
</pre></div>

<p>相关参数</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span>    cfg:         Control flow graph. Please make sure each node has an associated `state` with it. You may
                            want to generate your CFG with `keep_state=True`.(cfg with state)
    start:       An address, Specifies where we start the generation of this data dependence graph.(分析ddg的起始地址)
    call_depth:  None or integers. A non-negative integer specifies how deep we would like to track in the
                            call tree. None disables call_depth limit.(调用深度限制)
    iterable or None block_addrs: A collection of block addresses that the DDG analysis should be performed
                                             on.(是什么再说)
</pre></div>

<p>重要变量</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span>    <span style="color: #75715e"># 输入的参数相关</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_cfg</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">cfg</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_start</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">project</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">entry</span> <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">start</span> <span style="color: #f92672">is</span> <span style="color: #f8f8f2">None</span> <span style="color: #66d9ef">else</span> <span style="color: #f8f8f2">start</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_call_depth</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">call_depth</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_block_addrs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">block_addrs</span>

    <span style="color: #75715e"># 结果存储</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_stmt_graph</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">networkx</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">DiGraph()</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_data_graph</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">networkx</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">DiGraph()</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_simplified_data_graph</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>

    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_ast_graph</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">networkx</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">DiGraph()</span>  <span style="color: #75715e"># A mapping of ProgramVariable to ASTs</span>

    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_symbolic_mem_ops</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">set()</span>

    <span style="color: #75715e"># 每个函数的数据依赖图</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_function_data_dependencies</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>

    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">view</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">DDGView(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_cfg,</span> <span style="color: #f8f8f2">self,</span> <span style="color: #f8f8f2">simplified</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">False)</span>
    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">simple_view</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">DDGView(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_cfg,</span> <span style="color: #f8f8f2">self,</span> <span style="color: #f8f8f2">simplified</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">True)</span>

    <span style="color: #75715e"># 其他</span>
</pre></div>

<p>Begin construction!</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span>    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_construct()</span>
</pre></div>

<h3 id="95constructself">构造_construct(self)<a class="headerlink" href="#95constructself" title="Permanent link">&para;</a></h3>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span>        <span style="color: #e6db74">&quot;&quot;&quot;</span>
<span style="color: #e6db74">        Construct the data dependence graph.</span>

<span style="color: #e6db74">        We track the following types of dependence:</span>
<span style="color: #e6db74">        - (Intra-IRSB) temporary variable dependencies</span>
<span style="color: #e6db74">        - 寄存器依赖</span>
<span style="color: #e6db74">        - 内存依赖, 尽管功能受限</span>

<span style="color: #e6db74">        追踪一下几种内存依赖:</span>
<span style="color: #e6db74">        - (Intra-functional) Stack read/write.</span>
<span style="color: #e6db74">            Trace changes of stack pointers inside a function, and the dereferences of stack pointers.</span>
<span style="color: #e6db74">        - (Inter-functional) Stack read/write.</span>
<span style="color: #e6db74">        - (Global) Static memory positions.</span>
<span style="color: #e6db74">            Keep a map of all accessible memory positions to their source statements per function. After that, we</span>
<span style="color: #e6db74">            traverse the CFG and link each pair of reads/writes together in the order of control-flow.</span>

<span style="color: #e6db74">        We do not track the following types of memory access</span>
<span style="color: #e6db74">        - Symbolic memory access</span>
<span style="color: #e6db74">            Well, they cannot be tracked under fastpath mode (which is the mode we are generating the CTF) anyways.</span>
<span style="color: #e6db74">        &quot;&quot;&quot;</span>
</pre></div>

<p>一些初始化操作</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span>        <span style="color: #75715e"># 初始化worklist,这一步将要分析的CFG node 加入worklist_set,将DDGJob 加入worklist</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_start</span> <span style="color: #f92672">is</span> <span style="color: #f8f8f2">None:</span>
            <span style="color: #75715e"># initial nodes are those nodes in CFG that has no in-degrees</span>
            <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">n</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_cfg</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">graph</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">nodes():</span>
                <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_cfg</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">graph</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">in_degree(n)</span> <span style="color: #f92672">==</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">:</span>
                    <span style="color: #75715e"># Put it into the worklist</span>
                    <span style="color: #f8f8f2">job</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">DDGJob(n,</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span>
                    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_worklist_append(job,</span> <span style="color: #f8f8f2">worklist,</span> <span style="color: #f8f8f2">worklist_set)</span>
        <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
            <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">n</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_cfg</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_all_nodes(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_start):</span>
                <span style="color: #f8f8f2">job</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">DDGJob(n,</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span>
                <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_worklist_append(job,</span> <span style="color: #f8f8f2">worklist,</span> <span style="color: #f8f8f2">worklist_set)</span>
                <span style="color: #e6db74">&quot;&quot;&quot;</span>
<span style="color: #e6db74">                增加一个CFGNode 和它的后继Node到work-list,这里同样要满足call-depth的限制</span>

<span style="color: #e6db74">                :param node_wrapper:    The NodeWrapper instance to insert.DDGJob</span>
<span style="color: #e6db74">                :param worklist:        The work-list, which is a list.</span>
<span style="color: #e6db74">                :param worklist_set:    A set of all CFGNodes that are inside the work-list, 为了加速查找.</span>
<span style="color: #e6db74">                                        It will be updated as well.</span>
<span style="color: #e6db74">                :returns:               A set of newly-inserted CFGNodes (not NodeWrapper instances).</span>
<span style="color: #e6db74">                # #</span>
<span style="color: #e6db74">                worklist.append(node_wrapper)　DDGJob的实例</span>
<span style="color: #e6db74">                worklist_set.add(node_wrapper.cfg_node)　添加的是cfg　node</span>

<span style="color: #e6db74">                &quot;&quot;&quot;</span>
</pre></div>

<p>开始循环处理
分析的对象是每个CFGJob，CFGJob是node和call deepth的封装，操作的是node的final state，call deepth用作限制分析的深度</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">live_defs_per_node</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{}</span>

<span style="color: #66d9ef">while</span> <span style="color: #f8f8f2">worklist:</span>
    <span style="color: #75715e"># pop 一个节点</span>
    <span style="color: #f8f8f2">ddg_job</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">worklist[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span>
    <span style="color: #f8f8f2">l</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">debug(</span><span style="color: #e6db74">&quot;Processing %s.&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">ddg_job)</span>
    <span style="color: #f8f8f2">node,</span> <span style="color: #f8f8f2">call_depth</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">ddg_job</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">cfg_node,</span> <span style="color: #f8f8f2">ddg_job</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">call_depth</span>
    <span style="color: #f8f8f2">worklist</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">worklist[</span> <span style="color: #ae81ff">1</span> <span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">]</span>
    <span style="color: #f8f8f2">worklist_set</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">remove(node)</span>

    <span style="color: #75715e"># 抓取所有的 final states. 通常超过一个 (对每一个 successor　都有一个state), 并处理它们</span>
    <span style="color: #75715e"># process all of them</span>
    <span style="color: #f8f8f2">final_states</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">node</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">final_states</span>

    <span style="color: #75715e">#为每个节点创建livedefinition对象实例，初步判定表示生命周期的数据定义</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">node</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">live_defs_per_node:</span>
        <span style="color: #f8f8f2">live_defs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">live_defs_per_node[node]</span>
    <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
        <span style="color: #f8f8f2">live_defs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">LiveDefinitions()</span>
        <span style="color: #f8f8f2">live_defs_per_node[node]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">live_defs</span>

    <span style="color: #f8f8f2">successing_nodes</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">list(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_cfg</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">graph</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">successors(node))</span>

    <span style="color: #75715e"># 尝试把每个final state分配给对应的后继node，反之亦然</span>
    <span style="color: #f8f8f2">match_suc</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">defaultdict(bool)</span>
    <span style="color: #f8f8f2">match_state</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">defaultdict(set)</span>

    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">suc</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">successing_nodes:</span>
        <span style="color: #f8f8f2">matched</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">False</span>
        <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">state</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">final_states:</span>
            <span style="color: #66d9ef">try</span><span style="color: #f8f8f2">:</span>
                <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">solver</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">eval(state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ip)</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">suc</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">addr:</span>　<span style="color: #75715e"># 判断这个state的跳转地址是否是后继node的地址</span>
                    <span style="color: #f8f8f2">match_suc[suc</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">addr]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>
                    <span style="color: #f8f8f2">match_state[state]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">add(suc)</span>
                    <span style="color: #f8f8f2">matched</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>
            <span style="color: #66d9ef">except</span> <span style="color: #f8f8f2">(SimUnsatError,</span> <span style="color: #f8f8f2">SimSolverModeError,</span> <span style="color: #a6e22e">ZeroDivisionError</span><span style="color: #f8f8f2">):</span>
                <span style="color: #75715e"># ignore</span>
                <span style="color: #f8f8f2">matched</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">matched</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">matched:</span>
            <span style="color: #66d9ef">break</span>

    <span style="color: #75715e"># 查看是否所有的final state都找到了它的后继node,以及后继node都有final state</span>
    <span style="color: #f8f8f2">matches</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">len(match_suc)</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">len(successing_nodes)</span> <span style="color: #f92672">and</span> <span style="color: #f8f8f2">len(match_state)</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">len(final_states)</span>

    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">state</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">final_states:</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">matches</span> <span style="color: #f92672">and</span> <span style="color: #f8f8f2">state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">history</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">jumpkind</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&#39;Ijk_FakeRet&#39;</span> <span style="color: #f92672">and</span> <span style="color: #f8f8f2">len(final_states)</span> <span style="color: #f92672">&gt;</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">:</span>
            <span style="color: #75715e"># Skip fakerets if there are other control flow transitions available</span>
            <span style="color: #66d9ef">continue</span>

        <span style="color: #f8f8f2">new_call_depth</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">call_depth</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">history</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">jumpkind</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&#39;Ijk_Call&#39;</span><span style="color: #f8f8f2">:</span>
            <span style="color: #f8f8f2">new_call_depth</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span>
        <span style="color: #66d9ef">elif</span> <span style="color: #f8f8f2">state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">history</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">jumpkind</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&#39;Ijk_Ret&#39;</span><span style="color: #f8f8f2">:</span>
            <span style="color: #f8f8f2">new_call_depth</span> <span style="color: #f92672">-=</span> <span style="color: #ae81ff">1</span>

        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_call_depth</span> <span style="color: #f92672">is</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">None</span> <span style="color: #f92672">and</span> <span style="color: #f8f8f2">call_depth</span> <span style="color: #f92672">&gt;</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_call_depth:</span>
            <span style="color: #f8f8f2">l</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">debug(</span><span style="color: #e6db74">&#39;Do not trace into %s due to the call depth limit&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ip)</span>
            <span style="color: #66d9ef">continue</span>

        <span style="color: #f8f8f2">new_defs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_track(state,</span> <span style="color: #f8f8f2">live_defs,</span> <span style="color: #f8f8f2">node</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">irsb</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">statements</span> <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">node</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">irsb</span> <span style="color: #f92672">is</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">None</span> <span style="color: #66d9ef">else</span> <span style="color: #f8f8f2">None)</span>

        <span style="color: #75715e">#corresponding_successors = [n for n in successing_nodes if</span>
        <span style="color: #75715e">#                            not state.ip.symbolic and n.addr == state.solver.eval(state.ip)]</span>
        <span style="color: #75715e">#if not corresponding_successors:</span>
        <span style="color: #75715e">#    continue</span>

        <span style="color: #f8f8f2">changed</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">False</span>

        <span style="color: #75715e"># if every successor can be matched with one or more final states (by IP address),</span>
        <span style="color: #75715e"># only take over the LiveDefinition of matching states</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">matches:</span>
            <span style="color: #f8f8f2">add_state_to_sucs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">match_state[state]</span>
        <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
            <span style="color: #f8f8f2">add_state_to_sucs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">successing_nodes</span>

        <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">successing_node</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">add_state_to_sucs:</span>

            <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">history</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">jumpkind</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&#39;Ijk_Call&#39;</span> <span style="color: #f92672">or</span> <span style="color: #f8f8f2">state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">history</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">jumpkind</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">startswith(</span><span style="color: #e6db74">&#39;Ijk_Sys&#39;</span><span style="color: #f8f8f2">))</span> <span style="color: #f92672">and</span> \
                    <span style="color: #f8f8f2">(state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ip</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">symbolic</span> <span style="color: #f92672">or</span> <span style="color: #f8f8f2">successing_node</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">addr</span> <span style="color: #f92672">!=</span> <span style="color: #f8f8f2">state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">solver</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">eval(state</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ip)):</span>
                <span style="color: #f8f8f2">suc_new_defs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_filter_defs_at_call_sites(new_defs)</span>
            <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
                <span style="color: #f8f8f2">suc_new_defs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">new_defs</span>

            <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">successing_node</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">live_defs_per_node:</span>
                <span style="color: #f8f8f2">defs_for_next_node</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">live_defs_per_node[successing_node]</span>
            <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
                <span style="color: #f8f8f2">defs_for_next_node</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">LiveDefinitions()</span>
                <span style="color: #f8f8f2">live_defs_per_node[successing_node]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">defs_for_next_node</span>

            <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">var,</span> <span style="color: #f8f8f2">code_loc_set</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">suc_new_defs</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">items():</span>
                <span style="color: #75715e"># l.debug(&quot;Adding %d new definitions for variable %s.&quot;, len(code_loc_set), var)</span>
                <span style="color: #f8f8f2">changed</span> <span style="color: #f92672">|=</span> <span style="color: #f8f8f2">defs_for_next_node</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">add_defs(var,</span> <span style="color: #f8f8f2">code_loc_set)</span>

        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">changed:</span>
            <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_call_depth</span> <span style="color: #f92672">is</span> <span style="color: #f8f8f2">None)</span> <span style="color: #f92672">or</span> \
                    <span style="color: #f8f8f2">(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_call_depth</span> <span style="color: #f92672">is</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">None</span> <span style="color: #f92672">and</span> <span style="color: #ae81ff">0</span> <span style="color: #f92672">&lt;=</span> <span style="color: #f8f8f2">new_call_depth</span> <span style="color: #f92672">&lt;=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_call_depth):</span>
                <span style="color: #75715e"># Put all reachable successors back to our work-list again</span>
                <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">successor</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_cfg</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_all_successors(node):</span>
                    <span style="color: #f8f8f2">nw</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">DDGJob(successor,</span> <span style="color: #f8f8f2">new_call_depth)</span>
                    <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_worklist_append(nw,</span> <span style="color: #f8f8f2">worklist,</span> <span style="color: #f8f8f2">worklist_set)</span>
</pre></div>

<p>Variable &lt;|Reg 16, 8B&gt;</p>
<div class="codehilite" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #66d9ef">class</span> <span style="color: #a6e22e">SimRegisterVariable</span><span style="color: #f8f8f2">(SimVariable):</span>

    <span style="color: #f8f8f2">__slots__</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&#39;reg&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;size&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;_hash&#39;</span><span style="color: #f8f8f2">]</span>

    <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__init__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">reg_offset,</span> <span style="color: #f8f8f2">size,</span> <span style="color: #f8f8f2">ident</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None,</span> <span style="color: #f8f8f2">name</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None,</span> <span style="color: #f8f8f2">region</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None,</span> <span style="color: #f8f8f2">category</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None):</span>
        <span style="color: #f8f8f2">SimVariable</span><span style="color: #f92672">.</span><span style="color: #a6e22e">__init__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">ident</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">ident,</span> <span style="color: #f8f8f2">name</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">name,</span> <span style="color: #f8f8f2">region</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">region,</span> <span style="color: #f8f8f2">category</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">category)</span>

        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">reg</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">reg_offset</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">size</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">size</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_hash</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>

    <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__repr__</span><span style="color: #f8f8f2">(self):</span>

        <span style="color: #f8f8f2">ident_str</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;[%s]&quot;</span> <span style="color: #f92672">%</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ident</span> <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ident</span> <span style="color: #66d9ef">else</span> <span style="color: #e6db74">&quot;&quot;</span>
        <span style="color: #f8f8f2">region_str</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">hex(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">region)</span> <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">isinstance(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">region,</span> <span style="color: #f8f8f2">int)</span> <span style="color: #66d9ef">else</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">region</span>

        <span style="color: #f8f8f2">s</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;&lt;%s%s|Reg %s, %sB&gt;&quot;</span> <span style="color: #f92672">%</span> <span style="color: #f8f8f2">(region_str,</span> <span style="color: #f8f8f2">ident_str,</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">reg,</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">size)</span>

        <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">s</span>

    <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__hash__</span><span style="color: #f8f8f2">(self):</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_hash</span> <span style="color: #f92672">is</span> <span style="color: #f8f8f2">None:</span>
            <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_hash</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">hash((</span><span style="color: #e6db74">&#39;reg&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">region,</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">reg,</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">size,</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ident))</span>
        <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_hash</span>

    <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__eq__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">other):</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">isinstance(other,</span> <span style="color: #f8f8f2">SimRegisterVariable):</span>
            <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ident</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">other</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ident</span> <span style="color: #f92672">and</span> \
                   <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">reg</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">other</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">reg</span> <span style="color: #f92672">and</span> \
                   <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">size</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">other</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">size</span> <span style="color: #f92672">and</span> \
                   <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">region</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">other</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">region</span>

        <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">False</span>

<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">SimVariable</span><span style="color: #f8f8f2">:</span>

    <span style="color: #f8f8f2">__slots__</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #e6db74">&#39;ident&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;name&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;region&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39;category&#39;</span><span style="color: #f8f8f2">]</span>

    <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__init__</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">ident</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None,</span> <span style="color: #f8f8f2">name</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None,</span> <span style="color: #f8f8f2">region</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None,</span> <span style="color: #f8f8f2">category</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None):</span>
        <span style="color: #e6db74">&quot;&quot;&quot;</span>
<span style="color: #e6db74">        :param ident: A unique identifier provided by user or the program. Usually a string.</span>
<span style="color: #e6db74">        :param str name: Name of this variable.</span>
<span style="color: #e6db74">        &quot;&quot;&quot;</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">ident</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">ident</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">name</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">name</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">region</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">region</span> <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">region</span> <span style="color: #f92672">is</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">None</span> <span style="color: #66d9ef">else</span> <span style="color: #e6db74">&quot;&quot;</span>
        <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">category</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">category</span>
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../cfg/" title="CFG" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                CFG
              </span>
            </div>
          </a>
        
        
          <a href="../fast-question/" title="fast-questions" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                fast-questions
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.c648116f.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../javascripts/jquery-3.4.1.min.js"></script>
      
        <script src="../../../javascripts/simpleLightbox.min.js"></script>
      
        <script src="../../../javascripts/custom.js"></script>
      
    
  </body>
</html>